
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all_nosearch.js"></script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
        </div>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
          </li>
          <li>
            <a href="#users" class="toc-h1 toc-link" data-title="Users">Users</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#register-new-user" class="toc-h2 toc-link" data-title="Users">Register new user</a>
                  </li>
                  <li>
                    <a href="#generate-user-specific-token" class="toc-h2 toc-link" data-title="Users">Generate user-specific token</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#fields" class="toc-h1 toc-link" data-title="Fields">Fields</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-field" class="toc-h2 toc-link" data-title="Fields">Create field</a>
                  </li>
                  <li>
                    <a href="#get-fields" class="toc-h2 toc-link" data-title="Fields">Get fields</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#projects" class="toc-h1 toc-link" data-title="Projects">Projects</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#create-project" class="toc-h2 toc-link" data-title="Projects">Create project</a>
                  </li>
                  <li>
                    <a href="#upload-project-imagery" class="toc-h2 toc-link" data-title="Projects">Upload project imagery</a>
                  </li>
                  <li>
                    <a href="#processing-uploaded-imagery" class="toc-h2 toc-link" data-title="Projects">Processing uploaded imagery</a>
                  </li>
                  <li>
                    <a href="#get-projects" class="toc-h2 toc-link" data-title="Projects">Get projects</a>
                  </li>
                  <li>
                    <a href="#project-outputs" class="toc-h2 toc-link" data-title="Projects">Project outputs</a>
                  </li>
                  <li>
                    <a href="#webhooks" class="toc-h2 toc-link" data-title="Projects">Webhooks</a>
                  </li>
              </ul>
          </li>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Solvi API is organized around REST and allows for programmatic access to resources like users and projects. Below you will find detailed information on how to access the API and which operations are currently supported.</p>

<p>In Solvi, a Project represents a single upload of multiple images. Projects can be grouped under Fields, which in turn are grouped into Farms to make it easier to organize and share data. Current API implementation allows to create and fetch projects for the specific user, as well as upload and stitch images into maps. Once processed, the outputs such as orthomosaics and elevation maps can either be accessed through the API or the user can be redirected to Solvi to view and analyze the processed imagery.</p>
<h1 id='authentication'>Authentication</h1>
<blockquote>
<p>Example API key request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"api_endpoint_here"</span>
  -H <span class="s2">"X-Api-Key: &lt;your-api-key&gt;"</span>
</code></pre>
<blockquote>
<p>Make sure to replace <code>&lt;your-api-key&gt;</code> with your API key.</p>
</blockquote>

<p>To use Solvi API you first need an <em>API key</em>. You will get an API key from Solvi, <a href="mailto:support@solvi.nu">contact us</a> to get your key. If you for some
reason need to revoke a key, you can also contact us.</p>

<p>Please note that the API key should be kept secret and not be exposed to end-users: for example, never send the API key to a web browser.</p>

<p>With the API key, you can access general API methods, for example, to <a href="#register-new-user">register new users</a> in Solvi, and create user-specific tokens.</p>

<p>Requests requiring an API key should add the <code>X-Api-Key</code> header:</p>

<p><code>X-Api-Key: &lt;your-api-key&gt;</code></p>

<blockquote>
<p>Example user-specific request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl <span class="s2">"api_endpoint_here"</span>
  -H <span class="s2">"Authorization: Bearer &lt;user-specific-token&gt;"</span>
</code></pre>
<blockquote>
<p>Make sure to replace <code>&lt;user-specific-token&gt;</code> with your token.</p>
</blockquote>

<p>All user-specific requests, like creating or getting projects, should use a user-specific token, which has a limited lifetime and can therefore, be used directly from a browser, or for passwordless authentication when the user is redirected from your portal to Solvi. A user-specific token can be used for a limited amount of time (currently 24 hours) before it expires. A user-specific token is created by using the <a href="#generate-user-specific-token">endpoint to create a user-specific token</a>.</p>

<p>User specific requests should use the <code>Authorization</code> header <em>instead of</em> the <code>X-Api-Key</code> header:</p>

<p><code>Authorization: Bearer &lt;user-specific-token&gt;</code></p>
<h1 id='users'>Users</h1><h2 id='register-new-user'>Register new user</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST
  -H <span class="s2">"X-Api-Key: &lt;your-api-key&gt;"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  -d <span class="s1">'{ "user": { "email": "john@example.com", "password": "password", "first_name": "John", "last_name": "Doe"}}'</span>
  <span class="s2">"https://solvi.ag/api/v1/users"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">182</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint registers a new user. If successful, the response will return <code>user_id</code> that you would use later to generate user-specific tokens.</p>
<h3 id='http-request'>HTTP Request</h3>
<p><code>POST https://solvi.ag/api/v1/users</code></p>
<h3 id='parameters'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>required</td>
<td>Email</td>
</tr>
<tr>
<td>password</td>
<td>required</td>
<td>Password</td>
</tr>
<tr>
<td>first_name</td>
<td>required</td>
<td>First name</td>
</tr>
<tr>
<td>last_name</td>
<td>required</td>
<td>Last name</td>
</tr>
</tbody></table>

<aside>
Parameters above must be wrapped into `user` attribute and sent as JSON payload in POST request, see the example.
</aside>
<h2 id='generate-user-specific-token'>Generate user-specific token</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET
  -H <span class="s2">"X-Api-Key: &lt;your-api-key&gt;"</span>
  <span class="s2">"https://solvi.ag/api/v1/users/&lt;user_id&gt;/token"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="p">,</span><span class="w">
    </span><span class="s2">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoyNiwiZXhwIjo0OCwiZXhwIjoxNTAxMjU2NzAyfQ.cu5zIye7ubBhv7YsFIxXkO0E_W0hG0VrlOTQx6L3b3c"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint gives a token for the specific user that should be used to create and retrieve user projects. Every request will generate na ew token. The token is valid for 24 hours.</p>
<h3 id='http-request-2'>HTTP Request</h3>
<p><code>GET https://solvi.ag/api/v1/users/&lt;user_id&gt;/token</code></p>
<h3 id='parameters-2'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>user_id</td>
<td>required</td>
<td>User ID given when user is created</td>
</tr>
</tbody></table>
<h1 id='fields'>Fields</h1><h2 id='create-field'>Create field</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  -d <span class="s1">'{"field": { "name": "Winter Wheat", "geom": "{\"type\":\"Polygon\",\"coordinates\":[[[100.0, 0.0],[101.0, 0.0],[101.0, 1.0],[100.0, 1.0],[100.0, 0.0]]]}"}}'</span>
  <span class="s2">"https://solvi.ag/api/v1/fields"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"field_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">793</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>Creates a new field. Field boundaries can be provided as Polygon or MultiPolygon in GeoJSON format. The response contains <code>field_id</code> which can be later used to relate projects to the specific field.</p>
<h3 id='http-request-3'>HTTP Request</h3>
<p><code>POST https://solvi.ag/api/v1/fields</code></p>
<h3 id='parameters-3'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td></td>
<td>Name of the the field</td>
</tr>
<tr>
<td>geom</td>
<td>optional</td>
<td>Boundaries of the field as a Polygon or Multipolygon in <a href="https://geojson.org/geojson-spec.html#introduction">GeoJSON format</a> and EPSG:4326 coordinate system(lonlat)</td>
</tr>
</tbody></table>
<h2 id='get-fields'>Get fields</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  <span class="s2">"https://solvi.ag/api/v1/fields"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">[</span><span class="w">
      </span><span class="p">{</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"wheat field"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"created_at"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-02-27T12:45:05.550Z"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"projects"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
              </span><span class="p">{</span><span class="w">
                  </span><span class="s2">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1291</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"processed"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"27-FEB-2018"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"field_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Wheat field"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"survey_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-02-26T14:19:36.000Z"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"upload_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-02-27T12:45:05.556Z"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/1291"</span><span class="p">,</span><span class="w">
                  </span><span class="s2">"thumbnail_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/1291/thumbnail.png"</span><span class="w">
              </span><span class="p">}</span><span class="w">
          </span><span class="p">]</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span></code></pre>
<p>Gets all user fields and a list of projects related to each field.</p>
<h3 id='http-request-4'>HTTP Request</h3>
<p><code>GET https://solvi.ag/api/v1/fields</code></p>
<h1 id='projects'>Projects</h1><h2 id='create-project'>Create project</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  -d <span class="s1">'{ "type": "overlapping", "field_id": "field_1", "field_name": "Wheat Field", "field_geom": "{\"type\":\"Polygon\",\"coordinates\":[[[100.0, 0.0],[101.0, 0.0],[101.0, 1.0],[100.0, 1.0],[100.0, 0.0]]]}" }'</span>
  <span class="s2">"https://solvi.ag/api/v1/projects"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"success"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">142</span><span class="p">,</span><span class="w">
    </span><span class="s2">"project_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/142/photos/upload"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"imagery_upload_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="s2">"https://solvi-projects-dev.s3.eu-west-1.amazonaws.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="p">[</span><span class="err">...</span><span class="p">]</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"key_prefix"</span><span class="p">:</span><span class="s2">"uploads/26c1ce11-c9bf-4825-821c-72e9f600a6cf/originals/"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>This endpoint creates a new project which is required before imagery upload. In response, you will receive URL to upload-page for the newly created project where the user can be redirected.</p>

<p>Projects can be connected to a Field. When multiple projects are related to the same Field, they appear in the same map view when data is processed. This allows for easier navigation between imagery over the same Field and over the time data comparison.</p>

<p>Fields can be created either beforehand - then <code>field_id</code> parameter should be specified when creating a project, or on the fly by sending in <code>field_name</code> and <code>field_geom</code>.</p>

<p>Optionally, a project can be created with a so-called <em>webhook</em> that will be called every time the status of the project changes. This makes it possible for integration to for example react when a project finishes processing, without having to use polling to check the project&#39;s status. To add a webhook, specify the URL to be called with the <code>status_webhook</code> parameter. See the section on <a href="#webhooks">webhooks</a> for details.</p>
<h3 id='http-request-5'>HTTP Request</h3>
<p><code>POST https://solvi.ag/api/v1/projects</code></p>
<h3 id='parameters-4'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>type</td>
<td>optional</td>
<td>The type of imagery for this project: <code>overlapping</code> or <code>stitched</code>; default is <code>overlapping</code></td>
</tr>
<tr>
<td>field_id</td>
<td></td>
<td>Unique field identifier</td>
</tr>
<tr>
<td>field_name</td>
<td>optional</td>
<td>Name of the the field</td>
</tr>
<tr>
<td>field_geom</td>
<td>optional</td>
<td>Boundaries of the field as a polygon in <a href="https://geojson.org/geojson-spec.html#introduction">GeoJSON format</a> and EPSG:4326 coordinate system(lonlat)</td>
</tr>
<tr>
<td>status_webhook</td>
<td>optional</td>
<td>A URL to be called when the project&#39;s status changes</td>
</tr>
<tr>
<td>webhook_secret</td>
<td>optional</td>
<td>A token to use to sign webhook requests, see <a href="#webhooks">webhooks</a> for details</td>
</tr>
</tbody></table>
<h2 id='upload-project-imagery'>Upload project imagery</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  <span class="s2">"https://solvi.ag/api/v1/projects/&lt;project_id&gt;/begin_upload"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"upload_imagery_data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi-projects.s3.eu-west-1.amazonaws.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"fields"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"x-amz-storage-class"</span><span class="p">:</span><span class="w"> </span><span class="s2">"STANDARD_IA"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"policy"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJleHBpcmF0aW9uIjoiMjAyMC0wOC0wN1QwNzozMjo1MVoiLCJjb25kaXRpb25zIjpbeyJidWNrZXQiOiJzb2x2aS1wcm9qZWN0cy1kZXYifSxbInN0YXJ0cy13aXRoIiwiJGtleSIsInVwbG9hZHMvMjZjMWNlMTEtYzliZi00ODI1LTgyMWMtNzJlOWY2MDBhNmNmL29yaWdpbmFscy8iXSxbInN0YXJ0cy13aXRoIiwiJENvbnRlbnQtVHlwZSIsIiJdLHsieC1hbXotc3RvcmFnZS1jbGFzcyI6IlNUQU5EQVJEX0lBIn0seyJ4LWFtei1jcmVkZW50aWFsIjoiQUtJQVVWTUhLR1RRRldMTlkyTUgvMjAyMDA4MDUvZXUtd2VzdC0xL3MzL2F3czRfcmVxdWVzdCJ9LHsieC1hbXotYWxnb3JpdGhtIjoiQVdTNC1ITUFDLVNIQTI1NiJ9LHsieC1hbXotZGF0ZSI6IjIwMjAwODA1VDA3MzI1MVoifV18"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"x-amz-credential"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AKIAUVMHKGTQFWLNY2MX/20200805/eu-west-1/s3/aws4_request"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"x-amz-algorithm"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AWS4-HMAC-SHA256"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"x-amz-date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"20200805T073251Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"x-amz-signature"</span><span class="p">:</span><span class="w"> </span><span class="s2">"5494b8f7ca5c78c45daf7d8099f3c4b93e141567d3691dbec3dcc0f6fd2e0181"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"key_prefix"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uploads/26c1ce11-c9bf-4825-821c-72e9f600a6cf/originals/"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>After a project has been created, imagery can be uploaded to it by sending the <code>begin_upload</code> request. The response includes information required to upload
imagery for the project.</p>

<blockquote>
<p>Example JavaScript function to POST an image using <code>upload_imagery_data</code>:</p>
</blockquote>
<pre class="highlight javascript"><code>  <span class="kd">function</span> <span class="nx">uploadFile</span> <span class="p">(</span><span class="nx">upload_imagery_data</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span> <span class="p">{</span>
    <span class="kr">const</span> <span class="nx">form</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">()</span>
    <span class="nb">Object</span><span class="p">.</span><span class="nx">keys</span><span class="p">(</span><span class="nx">upload_imagery_data</span><span class="p">.</span><span class="nx">fields</span><span class="p">).</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">field</span> <span class="o">=&gt;</span> <span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">field</span><span class="p">,</span> <span class="nx">upload_imagery_data</span><span class="p">.</span><span class="nx">fields</span><span class="p">[</span><span class="nx">field</span><span class="p">]))</span>
    <span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'key'</span><span class="p">,</span> <span class="nx">upload_imagery_data</span><span class="p">.</span><span class="nx">key_prefix</span> <span class="o">+</span> <span class="nx">f</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span>
    <span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'Content-Type'</span><span class="p">,</span> <span class="nx">f</span><span class="p">.</span><span class="nx">type</span><span class="p">)</span>
    <span class="nx">form</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">'file'</span><span class="p">,</span> <span class="nx">f</span><span class="p">)</span>

    <span class="k">return</span> <span class="nx">fetch</span><span class="p">(</span><span class="nx">postInfo</span><span class="p">.</span><span class="nx">url</span><span class="p">,</span> <span class="p">{</span> <span class="na">method</span><span class="p">:</span> <span class="s1">'POST'</span><span class="p">,</span> <span class="na">body</span><span class="p">:</span> <span class="nx">form</span> <span class="p">})</span>
  <span class="p">}</span>
</code></pre>
<p>The required parameters are included in the <code>upload_imagery_data</code> object: this object has a <code>url</code> property indicating the URL to POST imagery to, and a <code>fields</code> object, listing the HTTP form data fields required for the POST request. In addition to these fields, the form must also include a <code>key</code> field: the key is the must include a value prefixed by the <code>key_prefix</code> and value unique for each image (like its filename).</p>
<h3 id='http-request-6'>HTTP Request</h3>
<p><code>POST https://solvi.ag/api/v1/projects/&lt;project_id&gt;/begin_upload</code></p>
<h3 id='parameters-5'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>project_id</td>
<td>required</td>
<td>Project ID given when project is created</td>
</tr>
</tbody></table>
<h2 id='processing-uploaded-imagery'>Processing uploaded imagery</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X POST
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  -H <span class="s2">"Content-Type: application/json"</span>
  <span class="s2">"https://solvi.ag/api/v1/projects/&lt;project_id&gt;/complete_upload"</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ok"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>When project imagery has been uploaded, the upload must be completed, which will start the processing of the imagery.</p>
<h3 id='http-request-7'>HTTP Request</h3>
<p><code>POST https://solvi.ag/api/v1/projects/&lt;project_id&gt;/complete_upload</code></p>
<h3 id='parameters-6'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>project_id</td>
<td>required</td>
<td>Project ID given when project is created</td>
</tr>
</tbody></table>
<h2 id='get-projects'>Get projects</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  <span class="s1">'https://solvi.ag/api/v1/projects?field_geom={"type":"FeatureCollection","features":[{"type":"Feature","geometry":{"type":"Polygon","coordinates":[[[100.0, 0.0],[101.0, 0.0],[101.0, 1.0],[100.0, 1.0],[100.0, 0.0]]]}]}'</span>
</code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
        </span><span class="s2">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span><span class="p">,</span><span class="w">
        </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"processed"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25-JUN-2018"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span><span class="p">,</span><span class="w">
            </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Winter Wheat"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"identfier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WW-01"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"farm"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">656</span><span class="p">,</span><span class="w">
                </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Borgeby Farm"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="s2">"survey_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-25T19:19:27.000Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"upload_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-25T20:50:14.870Z"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/9999"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"thumbnail_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/9999/thumbnail.png"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"New project"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/new"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves all projects created by the user or shared with user by others. If field boundaries are provided, only projects whose extent overlaps boundaries are returned.</p>
<h3 id='http-request-8'>HTTP Request</h3>
<p><code>GET https://solvi.ag/api/v1/projects</code></p>
<h3 id='parameters-7'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>field_geom</td>
<td>optional</td>
<td>Boundaries of the field as a polygon in <a href="https://geojson.org/geojson-spec.html#introduction">GeoJSON format</a> and EPSG:4326 coordinate system(lonlat).</td>
</tr>
</tbody></table>
<h2 id='project-outputs'>Project outputs</h2>
<blockquote>
<p>Example request:</p>
</blockquote>
<pre class="highlight shell tab-shell"><code>curl -X GET
  -H <span class="s2">"Authorization: Bearer &lt;user-jwt-token&gt;"</span>
  <span class="s1">'https://solvi.ag/api/v1/projects/&lt;project-id&gt;
</span></code></pre>
<blockquote>
<p>Example response:</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
      </span><span class="s2">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span><span class="p">,</span><span class="w">
      </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"processed"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"25-JUN-2018"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"field"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9999</span><span class="p">,</span><span class="w">
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Winter Wheat"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"identfier"</span><span class="p">:</span><span class="w"> </span><span class="s2">"WW-01"</span><span class="p">,</span><span class="w">
          </span><span class="s2">"farm"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
              </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">656</span><span class="p">,</span><span class="w">
              </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Borgeby Farm"</span><span class="w">
          </span><span class="p">}</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"survey_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-25T19:19:27.000Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"upload_date"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2018-06-25T20:50:14.870Z"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/9999"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"thumbnail_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/9999/thumbnail.png"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"resources"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"thumbnail"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi.ag/projects/9999/thumbnail.png"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"ortho"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi-projects.s3.eu-west-1.amazonaws.com/uploads/ed12e5f6-b6c9-4df8-9522-1dbc29be854b/results/ortho.tiff?..."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dem"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://solvi-projects-dev.s3.eu-west-1.amazonaws.com/uploads/ed12e5f6-b6c9-4df8-9522-1dbc29be854b/results/dem.tiff?..."</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"tiles"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"ortho"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://ts1.solvi.nu/ed12e5f6-b6c9-4df8-9522-1dbc29be854b/ortho_rgb/{z}/{x}/{y}.png?token=..."</span><span class="p">,</span><span class="w">
        </span><span class="s2">"dem"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://ts1.solvi.nu/ed12e5f6-b6c9-4df8-9522-1dbc29be854b/dem_color/{z}/{x}/{y}.png?token=..."</span><span class="w">
      </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
</span></code></pre>
<p>This endpoint retrieves projects created by the user or shared with the user by others.</p>

<p>The included <code>resources</code> are URLs that can be used to fetch the project outputs. These resource URLs are temporary, with a lifetime of 15 minutes before they expire.</p>

<p>The response also includes URL templates for tiled maps in the <code>tiles</code> section: these URLs can be used directly with several popular map clients like <a href="https://openlayers.org/">OpenLayers</a> or <a href="https://leafletjs.com/">Leaflet</a>. The URLs are temporary, with a lifetime of at least 48 hours.</p>
<h3 id='http-request-9'>HTTP Request</h3>
<p><code>GET https://solvi.ag/api/v1/projects/&lt;project_id&gt;</code></p>
<h3 id='parameters-8'>Parameters</h3>
<table><thead>
<tr>
<th>Parameter</th>
<th></th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>project_id</td>
<td>required</td>
<td>Project ID given when project is created</td>
</tr>
</tbody></table>
<h2 id='webhooks'>Webhooks</h2>
<p>Webhooks allow setting up integrations that subscribe to certain events from Solvi. When one of those events is triggered, an HTTP POST payload is sent to the webhook&#39;s configured URL. Currently, project status is the only available webhook in Solvi.</p>

<blockquote>
<p>Example webhook request payload</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"project_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">8993</span><span class="p">,</span><span class="w">
  </span><span class="s2">"event_type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"status_changed"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"old_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"created"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"new_status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uploading"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>The webhook is configured when <a href="#create-project">creating a project</a> by specifing the <code>status_webhook</code> parameter, which should contain the URL of the webhook.</p>
<h3 id='securing-webhooks'>Securing webhooks</h3>
<p>To ensure that Solvi is the sender of the webhook requests, you can optionally also specify a secret token when registering the webhook, by using the <code>webhook_secret</code> parameter: the secret can be any string of your choosing.</p>

<blockquote>
<p>Example signature header</p>
</blockquote>
<pre class="highlight plaintext"><code>X-Solvi-Signature: sha1=494e5dbdd1afbe4d44091bf86872b5eb4b9133e5
</code></pre>
<p>When a secret token has been specified, Solvi will include the HTTP header <code>X-Solvi-Signature</code>, which will contain an HMAC-SHA1 signature of the body.</p>

<p>This follows the same pattern as <a href="https://docs.github.com/en/developers/webhooks-and-events/securing-your-webhooks">securing webhooks on GitHub</a>, except for using the header <code>X-Solvi-Signature</code> instead.</p>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
